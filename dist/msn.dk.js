"use strict";(async()=>{const e=["article"],t=["above-river-block","entry-point","desktop-feed-views","gallery-slideshow","cs-super-container","cs-responsive-feed-layout","cs-infopane-card","cs-card","cs-responsive-infopane","cs-feed-layout","cs-personalized-feed","cs-responsive-card","cs-native-ad-card","cs-content-card","cp-article","slide-metadata","views-native-ad","views-header-wc","waterfall-view-feed"],o=import(chrome.runtime.getURL("utils/hideTargets.js")),s=import(chrome.runtime.getURL("utils/getDefaultSelectors.js")),n=import(chrome.runtime.getURL("utils/getShadowDomTargetContent.js")),r=import(chrome.runtime.getURL("utils/hideShadowDomTargets.js")),[a,i]=await Promise.all([o,s,n,r]),c=i.getDefaultSelectors();let l=null;async function d(){await chrome.runtime.sendMessage({type:"GET_IS_BLOCKING"})?async function(){const o=await async function(){return await chrome.runtime.sendMessage({type:"GET_TARGETS"})}(),s=await chrome.runtime.sendMessage({type:"GET_STYLE"});a.hideTargets({targets:o,hideStyle:s,selectors:c,containerSelectors:e});m({shadowDomtargetRefs:h({targets:o,shadowDomSelectors:t}),hideStyle:s}),function({targets:o,hideStyle:s}){l&&l.disconnect(),l=new MutationObserver((n=>{a.hideTargets({targets:o,hideStyle:s,selectors:c,containerSelectors:e});m({shadowDomtargetRefs:h({targets:o,shadowDomSelectors:t}),hideStyle:s})})),l.observe(document.body,{childList:!0,subtree:!0,characterData:!0})}({targets:o,hideStyle:s}),u.observe(document.body)}():async function(){l&&l.disconnect();document.querySelectorAll(".silent-blocking-extension").forEach((e=>{e.classList.remove("silent-blocking-extension"),e.classList.remove("hidden"),e.removeAttribute("data-silent-blocking-extension")})),g()}()}const u=new ResizeObserver((e=>{d()}));function h({root:e=document,targets:t,shadowDomSelectors:o}){const s=[];return function e({root:t,targets:o,shadowDomSelectors:n}){const r=t.querySelectorAll(n);r.length&&(r.forEach((e=>{const t=e.shadowRoot?.textContent;o.some((e=>{const{target:o,ignoreCase:s}=e;return s?t.toLowerCase().includes(o.toLowerCase()):t.includes(o)}))&&s.push(e)})),r.forEach((t=>{t.shadowRoot&&e({root:t.shadowRoot,targets:o,shadowDomSelectors:n})})))}({root:e,targets:t,shadowDomSelectors:o}),s}function m({shadowDomtargetRefs:e,hideStyle:t}){if(!e.length)return;document.createElement("style").setAttribute("data-silent-blocking-extension","true");const o="off"===t?" :host {\n      display: none !important;\n      }":" :host {\n        background-color: rgb(227, 243, 250) !important;\n        box-shadow: inset 0 0 0 4px lightblue !important;        \n        filter: blur(5px) !important;\n        }";e.forEach((e=>{const t=e.shadowRoot.querySelector('[data-silent-blocking-extension="true"]');t&&t.remove();const s=document.createElement("style");s.setAttribute("data-silent-blocking-extension","true"),s.textContent=o,e.shadowRoot.appendChild(s)}))}function g(e=document){const o=e.querySelectorAll(t);o.length&&o.forEach((e=>{if(e.shadowRoot){const t=e.shadowRoot.querySelector('[data-silent-blocking-extension="true"]');t&&t.remove()}g(e.shadowRoot)}))}d(),chrome.runtime.onMessage.addListener((async(e,t,o)=>{if("REINIT_BLOCKING"===e.type)return d(),o(!0)}))})();