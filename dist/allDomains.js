"use strict";(async()=>{if(!window.hasRun){window.hasRun=!0;const e=["div","span","p","h1","h2","h3","h4","h5","h6","li","a","img","b","strong"];let t=null;const n=await chrome.runtime.sendMessage({type:"GET_IS_DEFAULT_CAN_BE_BLOCKING"});if(!n)return;const s=d((e=>{e?i():a()}),500);async function o(){const e=await chrome.runtime.sendMessage({type:"GET_IS_BLOCKING"});s(e)}async function i(){const e=await r(),t=await chrome.runtime.sendMessage({type:"GET_STYLE"});c({targets:e,hideStyle:t}),l({targets:e,hideStyle:t})}async function a(){t&&t.disconnect(),setTimeout((()=>{document.querySelectorAll(".silent-blocking-extension").forEach((e=>{e.classList.remove("silent-blocking-extension"),e.classList.remove("hidden"),e.removeAttribute("data-silent-blocking-extension")}))}),500)}async function r(){return await chrome.runtime.sendMessage({type:"GET_TARGETS"})}function c({targets:t,hideStyle:n}){const s=document.body;t.forEach((t=>{s.querySelectorAll(e.join(",")).forEach((e=>{const s=u({el:e,target:t});s&&(s.classList.add("silent-blocking-extension"),"off"===n?s.classList.add("hidden"):s.classList.remove("hidden"),s.setAttribute("data-silent-blocking-extension","true"))}))}))}function l({targets:e,hideStyle:n}){t&&t.disconnect();const s=d((()=>c({targets:e,hideStyle:n})),500);t=new MutationObserver((e=>{s()})),t.observe(document.body,{childList:!0,subtree:!0,characterData:!0})}function d(e,t){let n,s;return function(){const o=this,i=arguments;s?(clearTimeout(n),n=setTimeout((function(){Date.now()-s>=t&&(e.apply(o,i),s=Date.now())}),t-(Date.now()-s))):(e.apply(o,i),s=Date.now())}}function u({el:e,target:t}){if(e.children.length&&(n=e,!Array.from(n.childNodes).some((e=>e.nodeType===Node.TEXT_NODE&&""!==e.nodeValue.trim()))))return null;var n;const{target:s,ignoreCase:o,removeBlock:i}=t,a=e.tagName.toLowerCase(),r=["b"].includes(a)?e.parentNode:e,c=r.textContent;if(!(o?c.toLowerCase().includes(s.toLowerCase()):c.includes(s)))return null;const l=i?r.closest(["article","div"].join(",")):r;return l||r}o(),chrome.runtime.onMessage.addListener((async(e,t,s)=>{if("REINIT_BLOCKING"===e.type&&n)return o(),s(!0)}))}})();